# üîÑ Firewall Policies no FortiGate

Este documento detalha como funcionam as **pol√≠ticas de firewall** no FortiGate, explicando seus componentes, objetos associados, uso de NAT, agendamento, FQDNs e boas pr√°ticas de configura√ß√£o e seguran√ßa.

---

## üîê O que s√£o Firewall Policies?

- S√£o o **conjunto de regras que controlam todo tr√°fego** que passa pelo FortiGate.
- Cada pol√≠tica define o **comportamento do tr√°fego entre origem e destino**.

### üìã Configura√ß√µes Principais de uma Regra

| Par√¢metro           | Descri√ß√£o                                                                 |
|---------------------|---------------------------------------------------------------------------|
| **Interface**        | Define onde o tr√°fego **entra** (ex: LAN, WAN, DMZ).                      |
| **Origem (Source)**  | IPs, sub-redes, objetos ou usu√°rios de onde o tr√°fego se origina.         |
| **Destino**          | IPs, sub-redes ou dom√≠nios de destino do tr√°fego.                         |
| **Schedule**         | Define **hor√°rios e dias** em que a regra est√° ativa.                     |
| **Service**          | Protocolos ou portas (ex: HTTP, HTTPS, FTP, ICMP).                        |
| **Action**           | A√ß√£o a ser tomada: `accept`, `deny` ou `ipsec`.                          |
| **NAT**              | Ativa ou n√£o a tradu√ß√£o de endere√ßos.                                     |
| **Security Profile** | Perfis de seguran√ßa aplicados: Web Filter, AntiVirus, App Control, etc.   |
| **Logs**             | Registro de logs para auditoria e troubleshooting.                        |

### üö´ Pol√≠tica Padr√£o

- O FortiGate **nega por padr√£o** todo tr√°fego que n√£o se encaixa em nenhuma pol√≠tica.
- Por isso, **regras de permiss√£o devem ser criadas manualmente** para liberar servi√ßos espec√≠ficos.

---

## üì¶ Objetos Utilizados nas Pol√≠ticas

Para facilitar a reutiliza√ß√£o e organiza√ß√£o das pol√≠ticas, o FortiGate utiliza **objetos** configur√°veis.

### Tipos Comuns de Objetos:

- **Interfaces** (ex: port1, WAN1, LAN)
- **Zonas** (agrupamentos l√≥gicos de interfaces)
- **Endere√ßos** (IPs, sub-redes, ranges, FQDNs)
- **Usu√°rios** (locais ou via LDAP/AD)
- **Servi√ßos** (protocolos como HTTP, DNS, etc.)
- **Calend√°rios (Schedules)**
- **Regras de NAT**
- **Security Profiles** (web filter, antivirus, etc.)

### üß© Observa√ß√µes Importantes

- Usar **zonas** permite aplicar a mesma regra a m√∫ltiplas interfaces.
- Ao aplicar uma **zona** em uma interface com pol√≠ticas j√° existentes, pode haver **conflitos**.  
  ‚û§ **Solu√ß√£o:** remova as pol√≠ticas antigas antes de aplicar a zona.

---

## üåê FQDN (Fully Qualified Domain Name)

- Permite criar regras com **endere√ßos baseados em nomes de dom√≠nio** (DNS).
- Exemplo de uso: permitir tr√°fego para `*.google.com`.

### üí° Aplica√ß√£o

- Cria-se um objeto do tipo `FQDN` com o dom√≠nio.
- Usa-se DNS confi√°vel (ex: 8.8.8.8) para resolu√ß√£o.

---

## üó∫Ô∏è Endere√ßos e Pol√≠ticas

- Pode-se criar objetos para:
  - Regi√µes geogr√°ficas (Geo-IP)
  - LANs espec√≠ficas
  - IPs individuais ou faixas
- **Fonte (source)** em uma pol√≠tica pode conter m√∫ltiplos objetos.
- √â poss√≠vel associar a pol√≠ticas usu√°rios autenticados via login.

---

## ‚è∞ Schedule (Agendamento de Pol√≠ticas)

- Define **quando uma pol√≠tica estar√° ativa** (dias da semana, horas espec√≠ficas).
- √ötil para:
  - Controle de hor√°rio de navega√ß√£o.
  - Libera√ß√£o de acesso tempor√°rio.
  - Bloqueios programados.

> Menu: `Policy & Objects > Schedules`

---

## üîÑ NAT (Network Address Translation)

- Controla a tradu√ß√£o de endere√ßos IP privados para p√∫blicos (e vice-versa).

### üß± Virtual IP (VIP)

- √â o equivalente a **DNAT**: direciona tr√°fego de IP p√∫blico para um IP interno.
- Usado para expor servidores internos (ex: webserver) via IP p√∫blico.

### ‚ö†Ô∏è Boas Pr√°ticas

- **Evite expor o FortiGate** diretamente na internet.
  - Use **VPNs** para acesso administrativo remoto.
- As regras NAT s√£o processadas **em ordem sequencial**.
  - ‚û§ A primeira que corresponder ser√° usada.
  - ‚û§ Coloque regras **mais espec√≠ficas antes das mais gen√©ricas**.

---

## üìò Exemplo de Pol√≠tica Completa

```plaintext
From: LAN
To: WAN
Source: Grupo de usu√°rios AD
Destination: all
Service: HTTP, HTTPS
Schedule: work_hours
Action: ACCEPT
NAT: Enabled
Security Profiles: Web Filter, Antivirus
Log Allowed Traffic: Enabled